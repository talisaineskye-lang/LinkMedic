module.exports=[93695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},50645,a=>{a.n(a.i(27572))},43619,a=>{a.n(a.i(79962))},13718,a=>{a.n(a.i(85523))},18198,a=>{a.n(a.i(45518))},62212,a=>{a.n(a.i(66114))},70844,a=>{a.n(a.i(92359))},39656,a=>{"use strict";let b={ctrPercent:2,conversionPercent:3,avgOrderValue:45};function c(a,d=b){let{ctrPercent:e,conversionPercent:f,avgOrderValue:g}=d;return Math.round(e/100*a*(f/100)*g*100)/100}function d(a){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(a)}function e(a){return a>=1e6?(a/1e6).toFixed(1)+"M":a>=1e3?(a/1e3).toFixed(1)+"K":a.toString()}a.s(["DEFAULT_SETTINGS",0,b,"calculateEstimatedLoss",()=>c,"formatCurrency",()=>d,"formatNumber",()=>e])},36350,a=>{"use strict";var b=a.i(39656);function c(a,d=b.DEFAULT_SETTINGS){return{id:a.id,videoId:a.video.id,videoTitle:a.video.title,videoViewCount:a.video.viewCount,url:a.originalUrl,status:a.status,merchant:a.merchant,lastCheckedAt:a.lastCheckedAt,estimatedLoss:(0,b.calculateEstimatedLoss)(a.video.viewCount,d)}}function d(a){return a.filter(a=>"NOT_FOUND"===a.status||"OOS"===a.status)}function e(a){return[...a].sort((a,b)=>{if(a.estimatedLoss!==b.estimatedLoss)return b.estimatedLoss-a.estimatedLoss;if(a.videoViewCount!==b.videoViewCount)return b.videoViewCount-a.videoViewCount;let c={NOT_FOUND:3,OOS:2,UNKNOWN:1,REDIRECT:0,OK:-1};return c[b.status]-c[a.status]})}function f(a,g=b.DEFAULT_SETTINGS,h=5){return e(d(a).map(a=>c(a,g))).slice(0,h)}function g(a,f=b.DEFAULT_SETTINGS){return e(d(a).map(a=>c(a,f)))}function h(a){let b=new Set(a.map(a=>a.videoId));return{total:a.length,broken:a.filter(a=>"NOT_FOUND"===a.status).length,outOfStock:a.filter(a=>"OOS"===a.status).length,totalEstimatedLoss:Math.round(100*a.reduce((a,b)=>a+b.estimatedLoss,0))/100,affectedVideos:b.size}}a.s(["getAllIssues",()=>g,"getFixFirst",()=>f,"getIssueStats",()=>h])},47987,a=>{"use strict";a.s(["SyncButton",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call SyncButton() from the server but SyncButton is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/sync-button.tsx <module evaluation>","SyncButton")},159,a=>{"use strict";a.s(["SyncButton",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call SyncButton() from the server but SyncButton is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/sync-button.tsx","SyncButton")},41977,a=>{"use strict";a.i(47987);var b=a.i(159);a.n(b)},73379,a=>{"use strict";a.s(["ScanButton",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call ScanButton() from the server but ScanButton is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/scan-button.tsx <module evaluation>","ScanButton")},62701,a=>{"use strict";a.s(["ScanButton",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call ScanButton() from the server but ScanButton is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/scan-button.tsx","ScanButton")},64986,a=>{"use strict";a.i(73379);var b=a.i(62701);a.n(b)},44538,a=>a.a(async(b,c)=>{try{var d=a.i(7997),e=a.i(20971),f=a.i(9307),g=a.i(61469),h=a.i(36350),i=a.i(39656),j=a.i(41977),k=a.i(64986),l=a.i(95936),m=b([f,g]);async function n(){let a=await (0,e.getServerSession)(f.authOptions);if(!a?.user?.id)return null;let b=await g.prisma.user.findUnique({where:{id:a.user.id},select:{ctrPercent:!0,conversionPercent:!0,avgOrderValue:!0}}),c={ctrPercent:b?.ctrPercent??2,conversionPercent:b?.conversionPercent??3,avgOrderValue:b?.avgOrderValue??45},m=await g.prisma.affiliateLink.findMany({where:{video:{userId:a.user.id}},select:{id:!0,originalUrl:!0,status:!0,merchant:!0,lastCheckedAt:!0,video:{select:{id:!0,title:!0,viewCount:!0}}}}),n=await g.prisma.video.count({where:{userId:a.user.id}}),o=(0,h.getFixFirst)(m,c,5);(0,h.getIssueStats)(o.length>0?o:[]);let p=m.filter(a=>"NOT_FOUND"===a.status||"OOS"===a.status).length,q=m.filter(a=>"NOT_FOUND"===a.status||"OOS"===a.status).reduce((a,b)=>{let d=b.video.viewCount*(c.ctrPercent/100)*(c.conversionPercent/100)*c.avgOrderValue;return a+d},0);return(0,d.jsxs)("div",{className:"space-y-8",children:[(0,d.jsxs)("div",{className:"flex justify-between items-center",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard"}),(0,d.jsx)("p",{className:"text-gray-600",children:"Monitor your affiliate link health"})]}),(0,d.jsxs)("div",{className:"flex gap-3",children:[(0,d.jsx)(j.SyncButton,{}),(0,d.jsx)(k.ScanButton,{})]})]}),(0,d.jsxs)("div",{className:"grid grid-cols-4 gap-4",children:[(0,d.jsxs)("div",{className:"bg-white p-6 rounded-lg border",children:[(0,d.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Videos"}),(0,d.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:(0,i.formatNumber)(n)})]}),(0,d.jsxs)("div",{className:"bg-white p-6 rounded-lg border",children:[(0,d.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Links Scanned"}),(0,d.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:(0,i.formatNumber)(m.length)})]}),(0,d.jsxs)("div",{className:"bg-white p-6 rounded-lg border",children:[(0,d.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Issues Found"}),(0,d.jsx)("div",{className:"text-2xl font-bold text-red-600",children:p})]}),(0,d.jsxs)("div",{className:"bg-white p-6 rounded-lg border",children:[(0,d.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Est. Revenue at Risk"}),(0,d.jsx)("div",{className:"text-2xl font-bold text-red-600",children:(0,i.formatCurrency)(q)})]})]}),(0,d.jsxs)("div",{className:"bg-white rounded-lg border",children:[(0,d.jsxs)("div",{className:"px-6 py-4 border-b",children:[(0,d.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Fix First"}),(0,d.jsx)("p",{className:"text-sm text-gray-600",children:"Top 5 issues by estimated revenue impact"})]}),0===o.length?(0,d.jsx)("div",{className:"p-6 text-center text-gray-500",children:0===m.length?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("p",{className:"mb-2",children:"No links found yet."}),(0,d.jsx)("p",{className:"text-sm",children:'Click "Sync Videos" to import your YouTube videos.'})]}):(0,d.jsx)("p",{children:"No issues found. All your links are healthy!"})}):(0,d.jsxs)("table",{className:"w-full",children:[(0,d.jsx)("thead",{className:"bg-gray-50",children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Video"}),(0,d.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Link"}),(0,d.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,d.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Est. Loss"})]})}),(0,d.jsx)("tbody",{className:"divide-y divide-gray-200",children:o.map(a=>(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{className:"px-6 py-4",children:[(0,d.jsx)(l.default,{href:`/videos/${a.videoId}`,className:"text-sm text-gray-900 hover:text-blue-600",children:a.videoTitle.length>50?a.videoTitle.slice(0,50)+"...":a.videoTitle}),(0,d.jsxs)("div",{className:"text-xs text-gray-500",children:[(0,i.formatNumber)(a.videoViewCount)," views"]})]}),(0,d.jsx)("td",{className:"px-6 py-4",children:(0,d.jsx)("a",{href:a.url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline truncate block max-w-xs",children:a.url.length>40?a.url.slice(0,40)+"...":a.url})}),(0,d.jsx)("td",{className:"px-6 py-4",children:(0,d.jsx)("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${"NOT_FOUND"===a.status?"bg-red-100 text-red-700":"OOS"===a.status?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-700"}`,children:"NOT_FOUND"===a.status?"Broken":"OOS"===a.status?"Out of Stock":a.status})}),(0,d.jsx)("td",{className:"px-6 py-4 text-right",children:(0,d.jsx)("span",{className:"text-sm font-medium text-red-600",children:(0,i.formatCurrency)(a.estimatedLoss)})})]},a.id))})]}),o.length>0&&(0,d.jsx)("div",{className:"px-6 py-4 border-t bg-gray-50",children:(0,d.jsx)(l.default,{href:"/issues",className:"text-sm text-blue-600 hover:underline",children:"View all issues â†’"})})]})]})}[f,g]=m.then?(await m)():m,a.s(["default",()=>n]),c()}catch(a){c(a)}},!1)];

//# sourceMappingURL=%5Broot-of-the-server%5D__54c311cd._.js.map