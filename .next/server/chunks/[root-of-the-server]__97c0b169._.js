module.exports=[70406,(t,e,r)=>{e.exports=t.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},93695,(t,e,r)=>{e.exports=t.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},18622,(t,e,r)=>{e.exports=t.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(t,e,r)=>{e.exports=t.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(t,e,r)=>{e.exports=t.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(t,e,r)=>{e.exports=t.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},63021,(t,e,r)=>{e.exports=t.x("@prisma/client-2c3a283f134fdcb6",()=>require("@prisma/client-2c3a283f134fdcb6"))},23862,t=>t.a(async(e,r)=>{try{let e=await t.y("pg-587764f78a6c7a9c");t.n(e),r()}catch(t){r(t)}},!0),26682,t=>{"use strict";let e=/https?:\/\/[^\s<>"{}|\\^`\[\]]+/gi,r=/^\d{1,2}:\d{2}(:\d{2})?$/,a=/^mailto:|@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,i=["amazon.com","amazon.co.uk","amazon.ca","amazon.de","amazon.fr","amazon.es","amazon.it","amazon.co.jp","amazon.com.au","amazon.in","amzn.to","amzn.com","a.co"],n=/\/(?:dp|gp\/product|ASIN)\/([A-Z0-9]{10})/i,s=/[?&](?:asin|ASIN)=([A-Z0-9]{10})/i,o=["utm_source","utm_medium","utm_campaign","utm_term","utm_content","ref","ref_","linkCode","linkId","pd_rd_i","pd_rd_r","pd_rd_w","pd_rd_wg","pf_rd_i","pf_rd_m","pf_rd_p","pf_rd_r","pf_rd_s","pf_rd_t","psc","smid","spLa","sr","th","fbclid","gclid","dclid"];function l(t){if(!t)return[];let l=t.match(e)||[],u=new Set,c=[];for(let t of l){let e=t.replace(/[.,;:!?)]+$/,"");if(r.test(e)||a.test(e))continue;let l=function(t){try{let e=new URL(t);return o.forEach(t=>{e.searchParams.delete(t)}),e.hash&&e.hash.includes("ref=")&&(e.hash=""),e.toString()}catch{return t}}(e);if(u.has(l))continue;u.add(l);let d=function(t){try{let e=new URL(t).hostname.toLowerCase();return i.some(t=>e===t||e.endsWith(`.${t}`))}catch{return!1}}(l),f=d?function(t){let e=t.match(n);if(e)return e[1];let r=t.match(s);if(r)return r[1]}(l):void 0;c.push({url:l,merchant:d?"amazon":"other",asin:f})}return c}function u(t){return t.filter(t=>"amazon"===t.merchant)}t.s(["extractLinksFromDescription",()=>l,"filterAffiliateLinks",()=>u])},88676,t=>{"use strict";let e=["Currently unavailable","Out of stock","We don't know when or if this item will be back","This item is not available","We don't know when or if this item will be back in stock","Available from these sellers","Sign up to be notified when this item becomes available"],r=["Page not found","404","Product not found","This page doesn't exist","Sorry, we couldn't find that page","The page you requested could not be found"];function a(t){let e=t.toLowerCase();return r.some(t=>e.includes(t.toLowerCase()))}async function i(t,e={},r=1e4){let a=new AbortController,n=setTimeout(()=>a.abort(),r);try{return await fetch(t,{...e,signal:a.signal,redirect:"follow",headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8","Accept-Language":"en-US,en;q=0.5",...e.headers}})}finally{clearTimeout(n)}}async function n(t,r=!1){let s=null;for(let n=0;n<=2;n++){n>0&&await function(t){return new Promise(e=>setTimeout(e,t))}(1e3*Math.pow(2,n-1));try{let n;try{n=await i(t,{method:"HEAD"})}catch{n=await i(t,{method:"GET"})}let s=n.status,o=n.url;if(404===s||410===s)return{status:"NOT_FOUND",httpStatus:s,finalUrl:o,availabilityStatus:"broken",notes:`HTTP ${s}`};if(s>=400)return{status:"NOT_FOUND",httpStatus:s,finalUrl:o,availabilityStatus:"error",notes:`HTTP ${s}`};if(r&&200===s){let r=await i(t,{method:"GET"}),n=await r.text();if(a(n))return{status:"NOT_FOUND",httpStatus:s,finalUrl:r.url,availabilityStatus:"error_page",notes:"Redirected to error page"};if(function(t){let r=t.toLowerCase();return e.some(t=>r.includes(t.toLowerCase()))}(n))return{status:"OOS",httpStatus:s,finalUrl:r.url,availabilityStatus:"out_of_stock",notes:"Product appears to be out of stock"}}if(s>=200&&s<300){if(o!==t){let e=await i(t,{method:"GET"}),r=await e.text();if(a(r))return{status:"NOT_FOUND",httpStatus:s,finalUrl:e.url,availabilityStatus:"error_page",notes:"Redirected to error page"}}return{status:"OK",httpStatus:s,finalUrl:o,availabilityStatus:"available",notes:null}}if(s>=300&&s<400)return{status:"REDIRECT",httpStatus:s,finalUrl:o,availabilityStatus:"redirect",notes:`Redirected to ${o}`};return{status:"OK",httpStatus:s,finalUrl:o,availabilityStatus:"available",notes:null}}catch(t){if(s=t instanceof Error?t:Error(String(t)),2===n){let t="AbortError"===s.name||s.message.includes("timeout");return{status:"UNKNOWN",httpStatus:null,finalUrl:null,availabilityStatus:t?"timeout":"error",notes:t?"Request timed out":`Error: ${s.message}`}}}}return{status:"UNKNOWN",httpStatus:null,finalUrl:null,availabilityStatus:"error",notes:s?.message||"Unknown error"}}t.s(["checkLink",()=>n])},30421,t=>t.a(async(e,r)=>{try{var a=t.i(43793),i=t.i(26682),n=t.i(88676),s=e([a]);async function o(t){let e=await a.prisma.video.findMany({where:{userId:t},select:{id:!0,description:!0}}),r=0;for(let t of e){if(!t.description)continue;let e=(0,i.extractLinksFromDescription)(t.description);for(let n of(0,i.filterAffiliateLinks)(e))!await a.prisma.affiliateLink.findFirst({where:{videoId:t.id,originalUrl:n.url}})&&(await a.prisma.affiliateLink.create({data:{videoId:t.id,originalUrl:n.url,merchant:n.merchant}}),r++)}return{videos:e.length,links:r}}async function l(t,e=7){let r=new Date;r.setDate(r.getDate()-e);let i=await a.prisma.affiliateLink.findMany({where:{video:{userId:t},OR:[{lastCheckedAt:null},{lastCheckedAt:{lt:r}}]},select:{id:!0,originalUrl:!0,merchant:!0},take:100}),s=0,o=0;for(let t of i)try{let e="amazon"===t.merchant,r=await (0,n.checkLink)(t.originalUrl,e);await a.prisma.affiliateLink.update({where:{id:t.id},data:{status:r.status,lastCheckedAt:new Date}}),await a.prisma.scanResult.create({data:{affiliateLinkId:t.id,httpStatus:r.httpStatus,availabilityStatus:r.availabilityStatus,notes:r.notes}}),s++,("NOT_FOUND"===r.status||"OOS"===r.status)&&o++,await new Promise(t=>setTimeout(t,500))}catch(e){console.error(`Error checking link ${t.id}:`,e)}return{checked:s,issues:o}}async function u(t){let e=await a.prisma.affiliateLink.findMany({where:{video:{userId:t}},select:{status:!0,lastCheckedAt:!0}});return{totalLinks:e.length,checkedLinks:e.filter(t=>t.lastCheckedAt).length,okLinks:e.filter(t=>"OK"===t.status).length,brokenLinks:e.filter(t=>"NOT_FOUND"===t.status).length,oosLinks:e.filter(t=>"OOS"===t.status).length,unknownLinks:e.filter(t=>"UNKNOWN"===t.status).length}}[a]=s.then?(await s)():s,t.s(["extractLinksForUser",()=>o,"getScanStats",()=>u,"scanUserLinks",()=>l]),r()}catch(t){r(t)}},!1),4909,t=>{"use strict";let e={ctrPercent:2,conversionPercent:3,avgOrderValue:45};function r(t,a=e){let{ctrPercent:i,conversionPercent:n,avgOrderValue:s}=a;return Math.round(i/100*t*(n/100)*s*100)/100}function a(t){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t)}function i(t){let e=[];return void 0!==t.ctrPercent&&(t.ctrPercent<0||t.ctrPercent>100)&&e.push("CTR must be between 0 and 100%"),void 0!==t.conversionPercent&&(t.conversionPercent<0||t.conversionPercent>100)&&e.push("Conversion rate must be between 0 and 100%"),void 0!==t.avgOrderValue&&(t.avgOrderValue<0&&e.push("Average order value must be positive"),t.avgOrderValue>1e4&&e.push("Average order value seems too high")),{valid:0===e.length,errors:e}}t.s(["calculateEstimatedLoss",()=>r,"formatCurrency",()=>a,"validateSettings",()=>i])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__97c0b169._.js.map