module.exports=[70406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},93695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},874,(e,t,r)=>{t.exports=e.x("buffer",()=>require("buffer"))},92509,(e,t,r)=>{t.exports=e.x("url",()=>require("url"))},21517,(e,t,r)=>{t.exports=e.x("http",()=>require("http"))},49719,(e,t,r)=>{t.exports=e.x("assert",()=>require("assert"))},24836,(e,t,r)=>{t.exports=e.x("https",()=>require("https"))},18622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},24361,(e,t,r)=>{t.exports=e.x("util",()=>require("util"))},54799,(e,t,r)=>{t.exports=e.x("crypto",()=>require("crypto"))},63021,(e,t,r)=>{t.exports=e.x("@prisma/client-2c3a283f134fdcb6",()=>require("@prisma/client-2c3a283f134fdcb6"))},23862,e=>e.a(async(t,r)=>{try{let t=await e.y("pg-587764f78a6c7a9c");e.n(t),r()}catch(e){r(e)}},!0),45706,(e,t,r)=>{t.exports=e.x("querystring",()=>require("querystring"))},6461,(e,t,r)=>{t.exports=e.x("zlib",()=>require("zlib"))},27699,(e,t,r)=>{t.exports=e.x("events",()=>require("events"))},78295,e=>{e.v({name:"openid-client",version:"5.7.1",description:"OpenID Connect Relying Party (RP, Client) implementation for Node.js runtime, supports passportjs",keywords:["auth","authentication","basic","certified","client","connect","dynamic","electron","hybrid","identity","implicit","oauth","oauth2","oidc","openid","passport","relying party","strategy"],homepage:"https://github.com/panva/openid-client",repository:"panva/openid-client",funding:{url:"https://github.com/sponsors/panva"},license:"MIT",author:"Filip Skokan <panva.ip@gmail.com>",exports:{types:"./types/index.d.ts",import:"./lib/index.mjs",require:"./lib/index.js"},main:"./lib/index.js",types:"./types/index.d.ts",files:["lib","types/index.d.ts"],scripts:{format:"npx prettier --loglevel silent --write ./lib ./test ./certification ./types",test:"mocha test/**/*.test.js"},dependencies:{jose:"^4.15.9","lru-cache":"^6.0.0","object-hash":"^2.2.0","oidc-token-hash":"^5.0.3"},devDependencies:{"@types/node":"^16.18.106","@types/passport":"^1.0.16",base64url:"^3.0.1",chai:"^4.5.0",mocha:"^10.7.3",nock:"^13.5.5",prettier:"^2.8.8","readable-mock-req":"^0.2.2",sinon:"^9.2.4",timekeeper:"^2.3.1"},"standard-version":{scripts:{postchangelog:"sed -i '' -e 's/### \\[/## [/g' CHANGELOG.md"},types:[{type:"feat",section:"Features"},{type:"fix",section:"Fixes"},{type:"chore",hidden:!0},{type:"docs",hidden:!0},{type:"style",hidden:!0},{type:"refactor",section:"Refactor",hidden:!1},{type:"perf",section:"Performance",hidden:!1},{type:"test",hidden:!0}]}})},14747,(e,t,r)=>{t.exports=e.x("path",()=>require("path"))},26682,e=>{"use strict";let t=/https?:\/\/[^\s<>"{}|\\^`\[\]]+/gi,r=/^\d{1,2}:\d{2}(:\d{2})?$/,a=/^mailto:|@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,i=["amazon.com","amazon.co.uk","amazon.ca","amazon.de","amazon.fr","amazon.es","amazon.it","amazon.co.jp","amazon.com.au","amazon.in","amzn.to","amzn.com","a.co"],s=/\/(?:dp|gp\/product|ASIN)\/([A-Z0-9]{10})/i,n=/[?&](?:asin|ASIN)=([A-Z0-9]{10})/i,o=["utm_source","utm_medium","utm_campaign","utm_term","utm_content","ref","ref_","linkCode","linkId","pd_rd_i","pd_rd_r","pd_rd_w","pd_rd_wg","pf_rd_i","pf_rd_m","pf_rd_p","pf_rd_r","pf_rd_s","pf_rd_t","psc","smid","spLa","sr","th","fbclid","gclid","dclid"];function l(e){if(!e)return[];let l=e.match(t)||[],c=new Set,u=[];for(let e of l){let t=e.replace(/[.,;:!?)]+$/,"");if(r.test(t)||a.test(t))continue;let l=function(e){try{let t=new URL(e);return o.forEach(e=>{t.searchParams.delete(e)}),t.hash&&t.hash.includes("ref=")&&(t.hash=""),t.toString()}catch{return e}}(t);if(c.has(l))continue;c.add(l);let d=function(e){try{let t=new URL(e).hostname.toLowerCase();return i.some(e=>t===e||t.endsWith(`.${e}`))}catch{return!1}}(l),p=d?function(e){let t=e.match(s);if(t)return t[1];let r=e.match(n);if(r)return r[1]}(l):void 0;u.push({url:l,merchant:d?"amazon":"other",asin:p})}return u}function c(e){return e.filter(e=>"amazon"===e.merchant)}e.s(["extractLinksFromDescription",()=>l,"filterAffiliateLinks",()=>c])},88676,e=>{"use strict";let t=["Currently unavailable","Out of stock","We don't know when or if this item will be back","This item is not available","We don't know when or if this item will be back in stock","Available from these sellers","Sign up to be notified when this item becomes available"],r=["Page not found","404","Product not found","This page doesn't exist","Sorry, we couldn't find that page","The page you requested could not be found"];function a(e){let t=e.toLowerCase();return r.some(e=>t.includes(e.toLowerCase()))}async function i(e,t={},r=1e4){let a=new AbortController,s=setTimeout(()=>a.abort(),r);try{return await fetch(e,{...t,signal:a.signal,redirect:"follow",headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8","Accept-Language":"en-US,en;q=0.5",...t.headers}})}finally{clearTimeout(s)}}async function s(e,r=!1){let n=null;for(let s=0;s<=2;s++){s>0&&await function(e){return new Promise(t=>setTimeout(t,e))}(1e3*Math.pow(2,s-1));try{let s;try{s=await i(e,{method:"HEAD"})}catch{s=await i(e,{method:"GET"})}let n=s.status,o=s.url;if(404===n||410===n)return{status:"NOT_FOUND",httpStatus:n,finalUrl:o,availabilityStatus:"broken",notes:`HTTP ${n}`};if(n>=400)return{status:"NOT_FOUND",httpStatus:n,finalUrl:o,availabilityStatus:"error",notes:`HTTP ${n}`};if(r&&200===n){let r=await i(e,{method:"GET"}),s=await r.text();if(a(s))return{status:"NOT_FOUND",httpStatus:n,finalUrl:r.url,availabilityStatus:"error_page",notes:"Redirected to error page"};if(function(e){let r=e.toLowerCase();return t.some(e=>r.includes(e.toLowerCase()))}(s))return{status:"OOS",httpStatus:n,finalUrl:r.url,availabilityStatus:"out_of_stock",notes:"Product appears to be out of stock"}}if(n>=200&&n<300){if(o!==e){let t=await i(e,{method:"GET"}),r=await t.text();if(a(r))return{status:"NOT_FOUND",httpStatus:n,finalUrl:t.url,availabilityStatus:"error_page",notes:"Redirected to error page"}}return{status:"OK",httpStatus:n,finalUrl:o,availabilityStatus:"available",notes:null}}if(n>=300&&n<400)return{status:"REDIRECT",httpStatus:n,finalUrl:o,availabilityStatus:"redirect",notes:`Redirected to ${o}`};return{status:"OK",httpStatus:n,finalUrl:o,availabilityStatus:"available",notes:null}}catch(e){if(n=e instanceof Error?e:Error(String(e)),2===s){let e="AbortError"===n.name||n.message.includes("timeout");return{status:"UNKNOWN",httpStatus:null,finalUrl:null,availabilityStatus:e?"timeout":"error",notes:e?"Request timed out":`Error: ${n.message}`}}}}return{status:"UNKNOWN",httpStatus:null,finalUrl:null,availabilityStatus:"error",notes:n?.message||"Unknown error"}}e.s(["checkLink",()=>s])},30421,e=>e.a(async(t,r)=>{try{var a=e.i(43793),i=e.i(26682),s=e.i(88676),n=t([a]);async function o(e){let t=await a.prisma.video.findMany({where:{userId:e},select:{id:!0,description:!0}}),r=0;for(let e of t){if(!e.description)continue;let t=(0,i.extractLinksFromDescription)(e.description);for(let s of(0,i.filterAffiliateLinks)(t))!await a.prisma.affiliateLink.findFirst({where:{videoId:e.id,originalUrl:s.url}})&&(await a.prisma.affiliateLink.create({data:{videoId:e.id,originalUrl:s.url,merchant:s.merchant}}),r++)}return{videos:t.length,links:r}}async function l(e,t=7){let r=new Date;r.setDate(r.getDate()-t);let i=await a.prisma.affiliateLink.findMany({where:{video:{userId:e},OR:[{lastCheckedAt:null},{lastCheckedAt:{lt:r}}]},select:{id:!0,originalUrl:!0,merchant:!0},take:100}),n=0,o=0;for(let e of i)try{let t="amazon"===e.merchant,r=await (0,s.checkLink)(e.originalUrl,t);await a.prisma.affiliateLink.update({where:{id:e.id},data:{status:r.status,lastCheckedAt:new Date}}),await a.prisma.scanResult.create({data:{affiliateLinkId:e.id,httpStatus:r.httpStatus,availabilityStatus:r.availabilityStatus,notes:r.notes}}),n++,("NOT_FOUND"===r.status||"OOS"===r.status)&&o++,await new Promise(e=>setTimeout(e,500))}catch(t){console.error(`Error checking link ${e.id}:`,t)}return{checked:n,issues:o}}async function c(e){let t=await a.prisma.affiliateLink.findMany({where:{video:{userId:e}},select:{status:!0,lastCheckedAt:!0}});return{totalLinks:t.length,checkedLinks:t.filter(e=>e.lastCheckedAt).length,okLinks:t.filter(e=>"OK"===e.status).length,brokenLinks:t.filter(e=>"NOT_FOUND"===e.status).length,oosLinks:t.filter(e=>"OOS"===e.status).length,unknownLinks:t.filter(e=>"UNKNOWN"===e.status).length}}[a]=n.then?(await n)():n,e.s(["extractLinksForUser",()=>o,"getScanStats",()=>c,"scanUserLinks",()=>l]),r()}catch(e){r(e)}},!1),46786,(e,t,r)=>{t.exports=e.x("os",()=>require("os"))},85685,e=>{e.v(e=>Promise.resolve().then(()=>e(54799)))},91961,e=>{e.v(t=>Promise.all(["server/chunks/[root-of-the-server]__fd7fc9d2._.js"].map(t=>e.l(t))).then(()=>t(12111)))},72331,e=>{e.v(t=>Promise.all(["server/chunks/node_modules_node-fetch_src_utils_multipart-parser_4bdf7e48.js","server/chunks/[root-of-the-server]__c08a7b0d._.js","server/chunks/[root-of-the-server]__d7ad26c7._.js"].map(t=>e.l(t))).then(()=>t(20442)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__93bf646d._.js.map